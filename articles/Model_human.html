<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example code for Human analysis • rRMSAnalyzer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example code for Human analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rRMSAnalyzer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rRMSAnalyzer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RibosomeCRCL/rRMSAnalyzer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example code for Human analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RibosomeCRCL/rRMSAnalyzer/blob/main/vignettes/Model_human.Rmd" class="external-link"><code>vignettes/Model_human.Rmd</code></a></small>
      <div class="d-none name"><code>Model_human.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="creation-of-a-new-folder-in-the-repository">Creation of a new folder in the repository<br><a class="anchor" aria-label="anchor" href="#creation-of-a-new-folder-in-the-repository"></a>
</h2>
<p><br></p>
<p>open your repository, go to your folder of interest <br> - create a
new folder<br> - copy and paste in this new folder:</p>
<ul>
<li>metadata.csv created previously: to update it, open metadata.csv in
Excel, fill in the file and save it using .csv with “;” as separator.
<br>
</li>
<li>rRMSAnalyzer_template.R (<a href="https://github.com/RibosomeCRCL/rRMSAnalyzer/tree/main/vignettes" class="external-link uri">https://github.com/RibosomeCRCL/rRMSAnalyzer/tree/main/vignettes</a>)
<br>
</li>
<li>“human.methylated.rda” and “human.suspected.rda” (<a href="https://github.com/RibosomeCRCL/rRMSAnalyzer/tree/main/data" class="external-link uri">https://github.com/RibosomeCRCL/rRMSAnalyzer/tree/main/data</a>)<br>
</li>
<li>a folder with all the 5’end read counts files<br>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="perform-analysis-using-rstudio">Perform analysis using RStudio<a class="anchor" aria-label="anchor" href="#perform-analysis-using-rstudio"></a>
</h2>
<div class="section level3">
<h3 id="open-rstudio">Open RStudio<a class="anchor" aria-label="anchor" href="#open-rstudio"></a>
</h3>
</div>
<div class="section level3">
<h3 id="update-rmsanalyzer">Update RMSAnalyzer<a class="anchor" aria-label="anchor" href="#update-rmsanalyzer"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"RibosomeCRCL/rRMSAnalyzer"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RibosomeCRCL/rRMSAnalyzer" class="external-link">rRMSAnalyzer</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="create-a-riboclass-metadata-counts-c-score-parameters">Create a RiboClass (metadata, counts, C-score parameters)<a class="anchor" aria-label="anchor" href="#create-a-riboclass-metadata-counts-c-score-parameters"></a>
</h2>
<p>As an example, the provided dataset “ribo_toy” is used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ribo_toy"</span><span class="op">)</span></span></code></pre></div>
<p>Personal data preparation</p>
<div class="section level3">
<h3 id="prepare-the-comparison-table">Prepare the comparison table<a class="anchor" aria-label="anchor" href="#prepare-the-comparison-table"></a>
</h3>
<ul>
<li>open the metadata.csv using Excel<br>
</li>
<li>add as many new columns as required (1 column per comparison, here
“column name = “variableA to C”)<br>
</li>
<li>complete the new columns with<br><ul>
<li>ctrl = control condition<br>
</li>
<li>P1 = condition 1<br>
</li>
<li>P2 = condition 2….<br> • NA = not applicable<br> Save your metadata
file using .csv and separator “;” <br>
</li>
</ul>
</li>
</ul>
<p>Here is an example of metadata:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="20%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="12%">
<col width="10%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th>filename</th>
<th>samplename</th>
<th>variableA</th>
<th>variableB</th>
<th>variableC</th>
<th>treatment</th>
<th>condition</th>
<th>lib</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>S26_R1.5_counts.csv</td>
<td>variableB_N2_P2</td>
<td>NA</td>
<td>P2</td>
<td>NA</td>
<td>variableB</td>
<td>P2</td>
<td>L2</td>
</tr>
<tr class="even">
<td>S27_R1.5_counts.csv</td>
<td>variableA_N2_P1</td>
<td>P1</td>
<td>NA</td>
<td>NA</td>
<td>variableA</td>
<td>P1</td>
<td>L2</td>
</tr>
<tr class="odd">
<td>S28_R1.5_counts.csv</td>
<td>variableC_N1_ctrl</td>
<td>NA</td>
<td>NA</td>
<td>ctrl</td>
<td>variableC</td>
<td>ctrl</td>
<td>L2</td>
</tr>
<tr class="even">
<td>S30_R1.5_counts.csv</td>
<td>variableB_N1_P2</td>
<td>NA</td>
<td>P2</td>
<td>NA</td>
<td>variableB</td>
<td>P2</td>
<td>L2</td>
</tr>
<tr class="odd">
<td>S31_R1.5_counts.csv</td>
<td>variableC_N2_P2</td>
<td>NA</td>
<td>NA</td>
<td>P2</td>
<td>variableC</td>
<td>P2</td>
<td></td>
</tr>
</tbody>
</table>
<p>In Rstudio, load a newRiboClass using:<br></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ribo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_ribodata.html">load_ribodata</a></span><span class="op">(</span></span>
<span>  <span class="co">#data &amp; metadata files path</span></span>
<span>  count_path <span class="op">=</span> <span class="st">"~/Desktop/RMS/path/counts/"</span>,</span>
<span>  metadata <span class="op">=</span> <span class="st">"~/Desktop/RMS/path/metadata.csv"</span>,<span class="co"># data &amp; metadata files separator</span></span>
<span>  count_sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  metadata_sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>  <span class="co"># count data parameters :</span></span>
<span>  count_header <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  count_value <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  count_rnaid <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  count_pos <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="co"># Metadata parameters :</span></span>
<span>  metadata_key <span class="op">=</span> <span class="st">"filename"</span>,</span>
<span>  metadata_id <span class="op">=</span> <span class="st">"samplename"</span>,</span>
<span>  <span class="co"># c-score parameters :</span></span>
<span>  flanking <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-importation-by-ploting-a-pca-and-coa">Check importation by ploting a PCA and COA<a class="anchor" aria-label="anchor" href="#check-importation-by-ploting-a-pca-and-coa"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_pca.html">plot_pca</a></span><span class="op">(</span><span class="va">ribo</span>,<span class="st">"run"</span><span class="op">)</span> <span class="co">#change column name of the lib if necessary #ribo_toy lib_col = "run"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_coa.html">plot_coa</a></span><span class="op">(</span></span>
<span>  <span class="va">ribo</span>,</span>
<span>  color_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  only_annotated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  object_only <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="perfom-qc-analysis">Perfom QC analysis<a class="anchor" aria-label="anchor" href="#perfom-qc-analysis"></a>
</h2>
<div class="section level4">
<h4 id="generate-a-qcreport">Generate a QCreport<a class="anchor" aria-label="anchor" href="#generate-a-qcreport"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/report_qc.html">report_qc</a></span><span class="op">(</span>ribo <span class="op">=</span> <span class="va">ribo</span>, specie <span class="op">=</span> <span class="st">"human"</span>, library_col <span class="op">=</span> <span class="st">"run"</span>, project_name <span class="op">=</span> <span class="st">"my_project"</span><span class="op">)</span> <span class="co">#ribo_toy lib_col = "run"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="adjustment-using-combat-seq-if-necessary">Adjustment using ComBat-Seq if necessary<a class="anchor" aria-label="anchor" href="#adjustment-using-combat-seq-if-necessary"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ribo_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_bias.html">adjust_bias</a></span><span class="op">(</span><span class="va">ribo_toy</span>,<span class="st">"run"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#verify the adjustment using a PCA</span></span>
<span><span class="fu"><a href="../reference/plot_pca.html">plot_pca</a></span><span class="op">(</span><span class="va">ribo_adj</span>,<span class="st">"lib"</span><span class="op">)</span>  <span class="co">#ribo_toy lib_col = "run"         </span></span>
<span></span>
<span><span class="fu"><a href="../reference/report_qc.html">report_qc</a></span><span class="op">(</span>ribo <span class="op">=</span> <span class="va">ribo_adj</span>, specie <span class="op">=</span> <span class="st">"human"</span>, library_col <span class="op">=</span> <span class="st">"run"</span>, project_name <span class="op">=</span> <span class="st">"name"</span>, comments <span class="op">=</span> <span class="st">"./comment_QC.Rmd"</span><span class="op">)</span> <span class="co">#ribo_toy lib_col = "run"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="remove-problematic-or-unused-samples-optionnal">Remove problematic or unused samples (optionnal)<a class="anchor" aria-label="anchor" href="#remove-problematic-or-unused-samples-optionnal"></a>
</h3>
<div class="section level4">
<h4 id="to-keep-a-small-number-of-samples">To keep a small number of samples<a class="anchor" aria-label="anchor" href="#to-keep-a-small-number-of-samples"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ribo_adj_small</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keep_ribo_samples.html">keep_ribo_samples</a></span><span class="op">(</span><span class="va">ribo_adj</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span>,<span class="st">"sample2"</span>,<span class="st">"sample3"</span>,<span class="st">"sample4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="to-remove-a-small-number-of-samples">To remove a small number of samples<a class="anchor" aria-label="anchor" href="#to-remove-a-small-number-of-samples"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ribo_adj_small</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_ribo_samples.html">remove_ribo_samples</a></span><span class="op">(</span><span class="va">ribo_adj</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xxxx"</span>,<span class="st">"xxxccc"</span>,<span class="st">"RNA_ref-1"</span>,<span class="st">"RNA_ref-2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="uniformisation-of-the-riboclass-name">Uniformisation of the RiboClass name<a class="anchor" aria-label="anchor" href="#uniformisation-of-the-riboclass-name"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ribo_adj</span> <span class="op">&lt;-</span> <span class="va">ribo_adj_small</span> </span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="annotation-of-human-rrna-2ome-sites">Annotation of human rRNA 2’Ome sites<a class="anchor" aria-label="anchor" href="#annotation-of-human-rrna-2ome-sites"></a>
</h3>
<p>Choose between 2 annotations: known (n=112 sites) or suspected
(n=17). This section or the next one. If the two annotations are
required, both of known and suspected sites analysis are desired, the 2
scripts has to be run twice from here.</p>
<div class="section level4">
<h4 id="annotation-of-the-112-known-sites">Annotation of the 112 known sites<a class="anchor" aria-label="anchor" href="#annotation-of-the-112-known-sites"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"human_methylated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"human_methylated's rna names: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">human_methylated</span><span class="op">$</span><span class="va">rRNA</span><span class="op">)</span>,<span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ribo's rna names: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ribo</span><span class="op">$</span><span class="va">rna_names</span><span class="op">$</span><span class="va">current_name</span><span class="op">)</span><span class="op">)</span> <span class="co"># change name of RiboClass if necessary</span></span>
<span></span>
<span><span class="va">ribo_adj_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_rna.html">rename_rna</a></span><span class="op">(</span><span class="va">ribo</span>, <span class="co">#change name of RiboClass if necessary for ribo_adj if you adjusted the data</span></span>
<span>                            new_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"5S"</span>, <span class="st">"5.8S"</span>, <span class="st">"18S"</span>, <span class="st">"28S"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ribo_adj_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_site.html">annotate_site</a></span><span class="op">(</span><span class="va">ribo_adj_name</span>, </span>
<span>                                annot <span class="op">=</span> <span class="va">human_methylated</span>,</span>
<span>                                anno_rna <span class="op">=</span> <span class="st">"rRNA"</span>,</span>
<span>                                anno_pos <span class="op">=</span> <span class="st">"Position"</span>,</span>
<span>                                anno_value <span class="op">=</span> <span class="st">"Nomenclature"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="annotation-of-the-19-suspected-sites">Annotation of the 19 suspected sites<a class="anchor" aria-label="anchor" href="#annotation-of-the-19-suspected-sites"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"/home/path/to/RMS/human.suspected.rda"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">ribo_adj_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_site.html">annotate_site</a></span><span class="op">(</span><span class="va">ribo_adj_annot</span>, <span class="va">human.suspected</span><span class="op">)</span> <span class="co"># verify rRNA names</span></span>
<span></span>
<span><span class="va">ribo_adj_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_site.html">annotate_site</a></span><span class="op">(</span><span class="va">ribo_adj_annot</span>,</span>
<span>                                annot <span class="op">=</span> <span class="va">human.suspected</span>,</span>
<span>                                anno_rna <span class="op">=</span> <span class="st">"rRNA"</span>,</span>
<span>                                anno_pos <span class="op">=</span> <span class="st">"Position"</span>,</span>
<span>                                anno_value <span class="op">=</span> <span class="st">"Nomenclature"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="analytic-reports">Analytic reports<a class="anchor" aria-label="anchor" href="#analytic-reports"></a>
</h3>
<div class="section level4">
<h4 id="reports-for-comparisons-explained-in-column-1">Reports for comparisons explained in column 1<a class="anchor" aria-label="anchor" href="#reports-for-comparisons-explained-in-column-1"></a>
</h4>
<p>In the previous example: in column “VariableA”, comparison ctrl vs P1
and ctrl vs P2</p>
<div class="section level5">
<h5 id="filter-the-data">Filter the data<a class="anchor" aria-label="anchor" href="#filter-the-data"></a>
</h5>
<p>To do only if you want to compare a subset of your samples (i.e., not
all the samples included in the RiboClass).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kept_samples</span> <span class="op">&lt;-</span> <span class="va">ribo_adj_annot</span><span class="op">$</span><span class="va">metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">variableA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># keep lines that are not "NA"</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">samplename</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ribo_adj_annot_variableA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keep_ribo_samples.html">keep_ribo_samples</a></span><span class="op">(</span><span class="va">ribo_adj_annot</span>,<span class="va">kept_samples</span><span class="op">)</span> <span class="co">#create a new RiboClass including the subdata variableA</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="create-mandatory-comparison-table-for-the-report_diff_sites">Create mandatory comparison table for the report_diff_sites<a class="anchor" aria-label="anchor" href="#create-mandatory-comparison-table-for-the-report_diff_sites"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparisons</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"comp1"</span>, <span class="st">"comp2"</span><span class="op">)</span>, <span class="co">#name of the 2 comparisons, add as many as required</span></span>
<span>  ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"ctrl"</span><span class="op">)</span>, <span class="co">#name of the ctrl as appearing in your metadata for each comparison, in the order, add as many name than comparison that will be performed</span></span>
<span>  cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P1"</span>, <span class="st">"P2"</span><span class="op">)</span> <span class="co">#name of the cases as appearing in your metadata for each comparison, in the order, add as many name than comparison that will be performed</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="generate-a-report-to-compare-2ome-profile">Generate a report to compare 2’Ome profile<a class="anchor" aria-label="anchor" href="#generate-a-report-to-compare-2ome-profile"></a>
</h5>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/report_2ome_sites.html">report_2ome_sites</a></span><span class="op">(</span>ribo <span class="op">=</span> <span class="va">ribo_adj_annot_variableA</span>, specie <span class="op">=</span> <span class="st">"human"</span>, condition_col <span class="op">=</span> <span class="st">"variableA"</span>, project_name <span class="op">=</span> <span class="st">"name"</span>, comments <span class="op">=</span> <span class="st">"./path/to/comment_2ome_variableA.Rmd"</span><span class="op">)</span> </span>
<span><span class="co">#condition_col: change the name of the column to perform new analysis</span></span>
<span><span class="co">#comments: change the path and name of your files with your comments if required</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="generate-a-report-to-perform-site-by-site-2ome-comparison">Generate a report to perform site-by-site 2’Ome comparison<a class="anchor" aria-label="anchor" href="#generate-a-report-to-perform-site-by-site-2ome-comparison"></a>
</h5>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/report_diff_sites.html">report_diff_sites</a></span><span class="op">(</span>ribo <span class="op">=</span> <span class="va">ribo_adj_annot_variableA</span>, specie <span class="op">=</span> <span class="st">"human"</span>, condition_col <span class="op">=</span> <span class="st">"variableA"</span>, project_name <span class="op">=</span> <span class="st">"name"</span>, comparisons <span class="op">=</span> <span class="va">comparisons</span>, comments <span class="op">=</span> <span class="st">"./comment_diff_site_variableA.Rmd"</span><span class="op">)</span></span>
<span><span class="co">#condition_col: change the name of the column to perform new analysis</span></span>
<span><span class="co">#comparisons: name of the comparison table</span></span>
<span><span class="co">#comments: change the name of your files with your comments if required</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="reports-for-comparisons-explained-in-column-2">Reports for comparisons explained in column 2<a class="anchor" aria-label="anchor" href="#reports-for-comparisons-explained-in-column-2"></a>
</h4>
<p>Re-do all the steps of <a href="#reports-for-comparisons-explained-in-column-1">Reports for
comparisons explained in column 1</a> but using the name of your column
of interest</p>
</div>
</div>
<div class="section level3">
<h3 id="export-data">Export data<a class="anchor" aria-label="anchor" href="#export-data"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ribo_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_data.html">extract_data</a></span><span class="op">(</span><span class="va">ribo_adj_annot</span>,</span>
<span>                        col <span class="op">=</span> <span class="st">"cscore"</span>,</span>
<span>                        only_annotated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">ribo_df</span>, <span class="st">"/path/to/folder/cscore_df.csv"</span><span class="op">)</span> <span class="co">#give path</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-local-environments-of-sites-of-interest-optionnal">Check local environments of sites of interest (optionnal)<a class="anchor" aria-label="anchor" href="#check-local-environments-of-sites-of-interest-optionnal"></a>
</h3>
<p>If you want to verify a site that shows up as significant in the last
report</p>
<p>For all samples</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_counts_env.html">plot_counts_env</a></span><span class="op">(</span><span class="va">ribo_adj_annot</span>, rna<span class="op">=</span> <span class="st">"18S"</span>, pos <span class="op">=</span> <span class="fl">1442</span>, samples <span class="op">=</span> <span class="st">"all"</span>, condition <span class="op">=</span> <span class="st">"condition"</span><span class="op">)</span></span></code></pre></div>
<p>For some samples</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_counts_env.html">plot_counts_env</a></span><span class="op">(</span><span class="va">ribo_adj_annot</span>, rna <span class="op">=</span> <span class="st">"18S"</span>, pos <span class="op">=</span> <span class="fl">1442</span>, samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span>, <span class="st">"sample2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] digest_0.6.37     desc_1.4.3        R6_2.6.1          fastmap_1.2.0    </span></span>
<span><span class="co">#&gt;  [5] xfun_0.53         cachem_1.1.0      knitr_1.50        htmltools_0.5.8.1</span></span>
<span><span class="co">#&gt;  [9] rmarkdown_2.29    lifecycle_1.0.4   cli_3.6.5         sass_0.4.10      </span></span>
<span><span class="co">#&gt; [13] pkgdown_2.1.3     textshaping_1.0.3 jquerylib_0.1.4   systemfonts_1.2.3</span></span>
<span><span class="co">#&gt; [17] compiler_4.5.1    tools_4.5.1       ragg_1.5.0        evaluate_1.0.5   </span></span>
<span><span class="co">#&gt; [21] bslib_0.9.0       yaml_2.3.10       jsonlite_2.0.0    rlang_1.1.6      </span></span>
<span><span class="co">#&gt; [25] fs_1.6.6          htmlwidgets_1.6.4</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Théo Combe, Hermes Paraqindes, Allyson Moureaux, Janice Kielbassa, Fleur Bourdelais, Sébastien Durand, Émilie Thomas, Anthony Ferrari, Virginie Marcel, Fondation Synergie Lyon Cancer, INCa, SIRIC program, LabEX program, Ligue Nationale Contre le Cancer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
